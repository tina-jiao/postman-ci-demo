# 流水线名称
name: Postman接口自动化测试
# 触发条件：往main分支提交代码时自动跑测试
on:
  push:
    branches: [ main ]

jobs:
  run-postman-test:
    # 用云端的Node.js环境，不用自己装软件
    runs-on: ubuntu-latest
    steps:
      # 步骤1：拉取仓库里的Postman文件
      - name: 拉取代码
        uses: actions/checkout@v4

      # 步骤2：安装Node.js（Newman依赖）
      - name: 安装Node.js
        uses: actions/setup-node@v4
        with:
          node-version: 18

      # 步骤3：安装Newman
      - name: 安装Newman
        run: npm install -g newman

      # 步骤4：执行Postman测试（新手改这里！）
      - name: 运行接口测试
        run: |
          newman run test.postman_collection.json \
          # 若有环境文件，取消下面这行注释并替换文件名
          # -e env.postman_environment.json \
          --insecure  # 跳过HTTPS证书报错（新手必加）
